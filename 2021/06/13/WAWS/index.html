<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="GinkGo">
    
    <title>
        
            谐波合成法的Python实现及其使用手册 |
        
        GinkGo
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="https://gitee.com/ginkgoltd/pictures/raw/master/img/ginkgo.jpg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"ginkgoltd.githut.io","root":"/","language":"en","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"https://gitee.com/ginkgoltd/pictures/raw/master/img/ginkgo.jpg","favicon":"https://gitee.com/ginkgoltd/pictures/raw/master/img/ginkgo.jpg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"To be continued ..."},"scroll":{"progress_bar":{"enable":false},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":false},"version":"3.4.3"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
<div class="progress-bar-container">
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                GinkGo
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/openVFIFE"
                            >
                                OPENVFIFE
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                CATEGORIES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                LINKS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/openVFIFE">OPENVFIFE</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">CATEGORIES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">LINKS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">谐波合成法的Python实现及其使用手册</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="https://gitee.com/ginkgoltd/pictures/raw/master/img/ginkgo.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">GinkGo</span>
                        
                            <span class="author-label">Lv1</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2021-06-13 00:41:02
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Softwae/">Softwae</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <p>程序地址：<a class="link"   target="_blank" rel="noopener" href="https://gitee.com/ginkgoltd/waws" >https://gitee.com/ginkgoltd/waws<i class="fas fa-external-link-alt"></i></a>, </p>
<p>编程语言：<code>Python3</code></p>
<p>作者：GinkGo</p>
<p>Email: ginkgoltd@outlook.com</p>
<p>谐波合成法以功率谱作为权系数，与一系列带随机相位的三角级数的加权和来逐渐逼近随机过程，适用于指定谱特征的平稳高斯随机过程。该方法有恒幅谐波叠加法和加权振幅谐波叠加法(尚未阅读相关文献). </p>
<h2 id="谐波合成法基本步骤"><a href="#谐波合成法基本步骤" class="headerlink" title="谐波合成法基本步骤"></a>谐波合成法基本步骤</h2><p><strong>Step 1: </strong> 选取目标风速谱$S(w)$和相干函数$coh(x_i, x_j, y_i, y_j, z_i, z_j, f)$,确定模拟点坐标</p>
<p><strong>Step 2: </strong>生成互谱密度矩阵</p>
<script type="math/tex; mode=display">
S(w) = \begin{bmatrix} S_{11}(\omega) &  S_{12}(\omega)  ...  & S_{1n}(\omega) \\
                   S_{21}(\omega) &  S_{22}(\omega)  ...  & S_{2n}(\omega) \\
                   . & ........ & . \\
                   . & ........ & . \\
                   . & ........ & . \\
                   S_{n1}(\omega) &  S_{n2}(\omega)  ...  & S_{nn}(\omega) \\\end{bmatrix}\\
S_{ij}(\omega)=\sqrt{ S_{i}(\omega) S_{j}(\omega)}coh(x_i,x_j,y_i,y_j,z_i,z_j,\omega)</script><p><strong>Step 3: </strong>对互谱密度矩阵进行cholesky分解</p>
<script type="math/tex; mode=display">
S(w) =H(w) H^T(w)\\\\
H(w) = \begin{bmatrix} H_{11}(\omega) &  0 ...  & 0 \\
                   H_{21}(\omega) &  H_{22}(\omega)  ...  & 0 \\
                   . & ........ & . \\
                   . & ........ & . \\
                   H_{n1}(\omega) & H_{n2}(\omega)  ...  & H_{nn}(\omega) \\\end{bmatrix}</script><p><strong>Step 4: (option 1):  </strong> M. Shinuzuka提出的单索引频率法</p>
<p>这种算法最简单, 只需互谱密度矩阵进行$N$次<code>cholesky</code>分解($n \times n$阶矩阵). 但是由于频率均匀分布可能导致模拟曲线出现周期性<sup><a href="#fn_1" id="reffn_1">1</a></sup>. (<em>具体情况尚未进行过详细地分析, 有机会在做吧, 暂且相信文献的结论</em>)</p>
<script type="math/tex; mode=display">
V_j(t) = 2\sqrt{\Delta \omega} \sum_{m=1}^{j} \sum_{l=1}^{N}|H_{jm}(\omega_{l})cos(\omega_l t + \theta_{jm}(\omega_l) + \phi_{ml})\\
\omega_l = l\Delta\omega, l = 1,2,3,...,N</script><p><strong>Step 4 (option 2): </strong> Deodatis双索引频率法计算模拟点风速时程</p>
<p>公式来源于&lt;基于实测风特性的台风模拟&gt;(杨素珍)<sup><a href="#fn_2" id="reffn_2">2</a></sup><br>由于option 1可能存在模拟风速时程出现周期性的问题, 引入了双索引频率, 将频率微小扰量均匀分布在频率增量内, 这样既可以采用FFT算法, 又能保证模拟曲线的各态历经性. 但互谱密度矩阵的分解数量将明显提升, 达到$N \times n$次($N$为频率等分数, $n$为模拟点数), 这样运算量将会增加; (但似乎采用<code>numpy.linalg.cholesky()</code>函数计算效率并不低)</p>
<script type="math/tex; mode=display">
V_j(t) = 2\sqrt{\Delta\omega}\sum_{m=1}^{j}\sum_{l=1}^{N}|H_{jm}(\omega_{ml})| cos(\omega_{ml}t - \theta(\omega_{ml}) + \phi_{ml})\\
\phi_{ml}=rand[0,2\pi]\\
\theta_{jm}=arctan[\frac{Im[H_{jm}(\omega_{ml})]}{Re[H_{jm}(\omega_{ml})]}]\\
\omega_{ml} = (l-1)\Delta\omega + m/n\Delta\omega, l=1,2,3,...,N</script><p><strong>注意:</strong> 有的文献中将$2\sqrt{\Delta\omega}$写成$\sqrt{2\Delta\omega}$这是错的<br><strong>注意:</strong> 如果$S(w)$为实正定矩阵,则$H(w)$也为实矩阵,因此$\theta_{jm}=0$</p>
<p>实际上, 在采用双索引算法时,并非$H(\omega_{ml})$矩阵中的所有元素都将用于最终的谐波叠加. 保留$H(\omega_{ml}$矩阵中用到的元素, 组成如下有效元素矩阵</p>
<script type="math/tex; mode=display">
H^{eff}(w) = \begin{bmatrix} H_{11}(\omega_{1l}) &  0 ...  & 0 \\
H_{21}(\omega_{1l}) &  H_{22}(\omega_{2l})  ...  & 0 \\
. & ........ & . \\
. & ........ & . \\
H_{n1}(\omega_{1l}) & H_{n2}(\omega_{2l})  ...  & H_{nn}(\omega_{nl}) \\\end{bmatrix}</script><p><strong>采用这种方式合成脉动风速需要多次累加计算, 模拟非常耗时, 尤其是当模拟点数较多时</strong></p>
<p><strong>Step 4 (option 3): </strong> 采用FFT技术加速风速时程的合成</p>
<p>公式都是自己推导的, 应该没有问题<br>实际计算过程中发现整个模拟过程中合成风速时程是比较耗时的, 而采用FFT技术可以显著提升模拟速度</p>
<script type="math/tex; mode=display">
V_j(t) = 2\sqrt{\Delta\omega}\sum_{m=1}^{j}\sum_{l=1}^{N}|H_{jm}(\omega)| cos(\omega_{ml}t - \theta(\omega_{ml}) + \phi_{ml})\\</script><p>引入欧拉公式$e^{ix} = cosx + isinx$,且$\theta_{jm}(\omega_{wl}=0$, 上式可以改写为</p>
<script type="math/tex; mode=display">
V_j(t) = 2\sqrt{\Delta\omega}\sum_{m=1}^{j}\sum_{l=1}^{N}|H_{jm}(\omega_{ml})| Re[e^{i(\omega_{ml}t + \phi_{ml})}]\\
= Re[2\sqrt{\Delta\omega}\sum_{m=1}^{j}\sum_{l=1}^{N}|H_{jm}(\omega_{ml})| e^{i\omega_{ml}t} e^{i\phi_{ml}}]\\
=Re[\sum_{m=1}^{j}(\sum_{l=1}^{N} 2 \sqrt{\Delta\omega} |H_{jm}(\omega_{ml})| e^{i\omega_{ml}t} e^{i\phi_{ml} })]</script><p>代入$\omega_{ml} = (l-1)\Delta\omega + \frac{m}{n}\Delta\omega$, 上式可以改写为</p>
<script type="math/tex; mode=display">
V_j(t) = Re[\sum_{m=1}^{j}(\sum_{l=1}^{N} 2 \sqrt{\Delta\omega} |H_{jm}(\omega_{ml})| e^{i((l-1)\Delta\omega + \frac{m}{n}\Delta\omega)t} e^{i\phi_{ml} })]\\
=Re[\sum_{m=1}^{j}(\sum_{l=1}^{N} 2 \sqrt{\Delta\omega} e^{i\phi_{ml}} |H_{jm}(\omega_{ml})| e^{i((l-1)\Delta\omega t} )e^{i\frac{m}{n}\Delta\omega t} ]\\
= Re[\sum_{m=1}^{j}G_{jm}(p\Delta t) e^{i\frac{m}{n} \Delta \omega t}]</script><p>注意, 上式中括号内部分刚好是离散傅里叶逆变换的表达式</p>
<script type="math/tex; mode=display">
G_{jm} = (\sum_{l=1}^{N} 2 \sqrt{\Delta\omega} e^{i\phi_{ml}} |H_{jm}(\omega_{ml})| e^{i(l-1)\Delta\omega t} )\\</script><p>令$k = l - 1, (k=0,1,2,…,N-1)$ 且 , $B_{jm} = 2 \sqrt{\Delta\omega} e^{i\phi_{ml}} |H_{jm}(\omega_{ml})|, \Delta\omega=\frac{\omega}{N}=\frac{2\pi f}{N}$,上式可以改写为</p>
<script type="math/tex; mode=display">
G_{jm}(p\Delta t) = (\sum_{l=1}^{N}B_{jm} e^{ik\Delta\omega t} ) = (\sum_{k=0}^{N-1}B_{jm} e^{i k \Delta \omega p\Delta t} )</script><p>信号的最长周期$T_0 = \frac{2\pi}{\Delta \omega}$, 若采样时间间隔为$\Delta t$, 一个周期内的时间点数为$M = \frac{T_0}{\Delta t}$, 则</p>
<script type="math/tex; mode=display">
T_0 = M \Delta t = \frac{2 \pi}{\Delta \omega}\\
\Delta t \Delta \omega = \frac{2 \pi}{M}</script><p>带入上上式中</p>
<script type="math/tex; mode=display">
G_{jm}(p\Delta t) = (\sum_{l=1}^{N}B_{jm} e^{ik\Delta\omega t} ) = (\sum_{k=0}^{M-1}B_{jm} e^{i kp \frac{2\pi}{M}})\\
B_{jm} = \left \{ 
\begin{aligned}
2 \sqrt{\Delta\omega} e^{i\phi_{ml}} |H_{jm}(\omega_{ml})|, 0 \leq l < N \\
0,  N \leq < l <M
\end{aligned}
\right.</script><p>而离散傅里叶逆变换的表达式为$x(t) = \frac{1}{N} \sum_{n=0}^{N-1} X(n) e^{i\frac{2 \pi}{N} t n}$ 因此, 可以对$B_{jm}$进行离散傅里叶逆变换从而提高运算效率, (FFT的时间复杂度为$nlog(n)$). </p>
<p><strong>说明1:</strong> 在很多文献中对这部分都描述为使用FFT技术加速计算, 然而并未提及到底是使用<code>fft</code>还是<code>ifft</code>; 另一方面在网络上看到的很多代码中, 都是直接使用<code>fft</code>进行计算的. 然而, 依据上述推导过程及表达式, 显然应该使用<code>ifft</code>才比较合理; 另一方面, 从物理意义上看, <code>ifft</code>是将信号从频域转换到时域, 和$B_{jm}转换到G_{jm}$这个过程也是吻合的. 此外, 为了验证采用<code>ifft</code>的正确性, 对比了直接采用Deodatis双索引公式合成的脉动风和采用<code>ifft</code>合成的脉动风速的时程和频谱, 结果表明二者完全一致, 这足以说明采用<code>ifft</code>的正确性.</p>
<p><strong>说明2: </strong>在很多文献<sup><a href="#fn_4" id="reffn_4">4</a></sup>中$p \Delta t, p=0,2,3,…, M<em>npts-1$ 生成风速的总时长都为$T=nT_0=npts</em>M<em>\Delta t$, <em>*我没搞懂这个是怎么来的?</em></em> 在我推导的表达式中, 模拟时长$T=T_0$与模拟点数$npts$并无关系, 实际模拟的结果无论是总能量还是频谱分布都吻合, 所以这个为啥这么做?</p>
<p><img src="https://gitee.com/ginkgoltd/pictures/raw/master/img/Fig2.png" alt=""></p>
<p><strong>Step 5 (option 1): </strong>平稳信号模拟的误差分析</p>
<p>完成全部模拟后, 应当对生成的信号进行误差分析, 以此判断模拟结果的精度, 误差分析应当包含如下几部分内容</p>
<ol>
<li>模拟谱与目标谱的对比, 能量分布应当吻合</li>
</ol>
<ul>
<li>绘制模拟谱与目标谱的对比图片</li>
</ul>
<ol>
<li><p>验证模拟信号是否满足各态历经性</p>
<p>参考文献<sup><a href="#fn_4" id="reffn_4">4</a></sup></p>
<p>根据维纳-辛钦定理, 平稳随机过程的功率谱密度与自相关函数满足如下关系(fft变换):</p>
<script type="math/tex; mode=display">
FFT: S(\omega) = \int_{-\infty}^{\infty} R(\tau) e^{-i \omega \tau} d\tau\\
IFFT: R(\tau) = \frac{1}{2\pi} \int_{-\infty} ^{\infty} S(\omega) e^{i \omega \tau} d\omega</script><ul>
<li>自/互相关函数对比</li>
</ul>
<p>ensemble auto-/cross-correlation function</p>
<script type="math/tex; mode=display">
R_{jk}^{0} (\tau) = R_{jk} (\tau) = \int_{-\infty}^{\infty} {S_{jk}^{0} (\omega) e^{i\omega \tau} d\omega}</script><p>temporal auto-/cross-correlation fuction</p>
<script type="math/tex; mode=display">
R_{jk}^{i}(\tau) = \frac{2} {T_0} \Delta \omega \sum_{m=1} ^{n} \sum_{l=0} ^{N-1} |H_{jm}(\omega_{ml})||H_{km}(\omega_{ml})| cos(\omega_{ml} \tau - \theta_{jm}(\omega_{ml}) + \theta_{km}(\omega_{ml}))\\
R_{jk}^{i}(\tau) =E[V_j(t) V_k(t + \tau)], j, k = 1, 2, 3, ..., n.</script></li>
<li><p>相干函数的对比, 空间相关性应该吻合</p>
<ul>
<li>相干函数的计算</li>
</ul>
<script type="math/tex; mode=display">
\gamma(w) = \frac{|S_{ij}(\omega)|}{\sqrt{S_{i}(\omega)S_j(\omega)}}</script><p>将上述公式计算的模拟信号之间的相干函数与目标相干函数之间进行对比</p>
</li>
</ol>
<p><strong>注意: </strong>上述比较都是通过比较二者之间的差距进行了, 实际上并没有一个精确的误差度量函数, 或许可以以后提出一个能够衡量随机信号模拟误差的函数</p>
<p><strong>Step 5 (option 2): </strong>非平稳信号的误差度量</p>
<ul>
<li>[ ] 尚未完成</li>
</ul>
<h2 id="关于一些参数的选择"><a href="#关于一些参数的选择" class="headerlink" title="关于一些参数的选择"></a>关于一些参数的选择</h2><h3 id="关于模拟时间间隔-Delta-t-的选取"><a href="#关于模拟时间间隔-Delta-t-的选取" class="headerlink" title="关于模拟时间间隔$\Delta t$的选取"></a>关于模拟时间间隔$\Delta t$的选取</h3><p>主要参考文献: &lt;谐波合成法脉动风模拟时间步长的取值&gt;(张军锋)<sup><a href="#fn_3" id="reffn_3">3</a></sup></p>
<h4 id="频率点数-N-的选取原则"><a href="#频率点数-N-的选取原则" class="headerlink" title="频率点数$N$的选取原则"></a>频率点数$N$的选取原则</h4><p>若模拟时将频率划分为$N$等份,则合成脉动风场时的频率分辨率为$\Delta\omega=\omega_u/N$.  显然,$N$越大, $\Delta\omega$越小, 模拟结果越精确, 根据Shinozuka<sup><a href="#fn_4" id="reffn_4">4</a></sup>的研究当$N&gt;1000$ 之后模拟结果已经足够精确. (需要说明的是, 这个值显然需要考虑$\omega_u$的大小, $N$的选取原则还是以$\Delta\omega$足够小来控制). $N$越大意味着频率分辨率越高, 结果越能反应目标谱的频率分布特征, 然而$N$越大, 需要进行cholesky分解的次数就越多, 合成风速时程的运算量也会相应增加, 模拟越耗时. </p>
<p>另一方面, 频率点数$N$对模拟结果的影响直接体现在结果的统计特征上, 下表给出了改变$N$时, 生成信号的均值和标准的变化. 同时也给出了功率谱</p>
<p>Table1. 均值随$N$的变化</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">z/m</th>
<th style="text-align:center">$N=2048, M=8192$</th>
<th style="text-align:center">$N=4096$</th>
<th style="text-align:center">$N=8192, M=16384$</th>
<th style="text-align:center">$N=2048, M=16384$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">-0.66821262</td>
<td style="text-align:center">-0.3449268</td>
<td style="text-align:center">-0.16279961</td>
<td style="text-align:center">-0.66799636</td>
</tr>
<tr>
<td style="text-align:center">20</td>
<td style="text-align:center">-0.56113631</td>
<td style="text-align:center">-0.37252204</td>
<td style="text-align:center">-0.16406671</td>
<td style="text-align:center">-0.5607632</td>
</tr>
<tr>
<td style="text-align:center">30</td>
<td style="text-align:center">-0.57451271</td>
<td style="text-align:center">-0.36096364</td>
<td style="text-align:center">-0.14268815</td>
<td style="text-align:center">-0.57402902</td>
</tr>
<tr>
<td style="text-align:center">40</td>
<td style="text-align:center">-0.6081656</td>
<td style="text-align:center">-0.38176085</td>
<td style="text-align:center">-0.14132875</td>
<td style="text-align:center">-0.60777049</td>
</tr>
<tr>
<td style="text-align:center">50</td>
<td style="text-align:center">-0.60592006</td>
<td style="text-align:center">-0.38206021</td>
<td style="text-align:center">-0.14138088</td>
<td style="text-align:center">-0.60559317</td>
</tr>
</tbody>
</table>
</div>
<p>Table1. 标准差随$N$的变化</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">z/m</th>
<th style="text-align:center">$N=2048, M=8192$</th>
<th style="text-align:center">$N=4096$</th>
<th style="text-align:center">$N=8192, M=16384$</th>
<th style="text-align:center">$N=2048, M=16384$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">3.87999986</td>
<td style="text-align:center">4.06380318</td>
<td style="text-align:center">4.1359681</td>
<td style="text-align:center">3.88004574</td>
</tr>
<tr>
<td style="text-align:center">20</td>
<td style="text-align:center">3.63991524</td>
<td style="text-align:center">4.17707677</td>
<td style="text-align:center">4.27935855</td>
<td style="text-align:center">3.63988511</td>
</tr>
<tr>
<td style="text-align:center">30</td>
<td style="text-align:center">3.77922552</td>
<td style="text-align:center">4.2882123</td>
<td style="text-align:center">4.29608268</td>
<td style="text-align:center">3.77915903</td>
</tr>
<tr>
<td style="text-align:center">40</td>
<td style="text-align:center">3.86934391</td>
<td style="text-align:center">4.26617434</td>
<td style="text-align:center">4.24411591</td>
<td style="text-align:center">3.86924546</td>
</tr>
<tr>
<td style="text-align:center">50</td>
<td style="text-align:center">3.91308826</td>
<td style="text-align:center">4.25154157</td>
<td style="text-align:center">4.28752741</td>
<td style="text-align:center">3.91299012</td>
</tr>
</tbody>
</table>
</div>
<p><img src="https://gitee.com/ginkgoltd/pictures/raw/master/img/Fig3.svg" alt=""></p>
<p>Fig.3 $N = 2048, M=16384$ </p>
<p><img src="https://gitee.com/ginkgoltd/pictures/raw/master/img/Fig4.svg" alt=""></p>
<p>Fig.4 $N = 4096, M=16384$ </p>
<p><img src="https://gitee.com/ginkgoltd/pictures/raw/master/img/Fig5.svg" alt=""></p>
<p>Fig.5 $N = 8192, M=16384$ </p>
<p>从Table1和Table2中可以看出, 随着$N$增加生成信号的均值逐渐趋于0, 标准差也逐渐趋于稳定; 而改变时间点数$M$对模拟结果影响非常小. 从频谱图中可以看出, 对于本算例, $N &gt; 2048$后, $N$基本不影响功率谱的模拟.</p>
<p>考察合成公式</p>
<script type="math/tex; mode=display">
V_j(t) = 2\sqrt{\Delta\omega}\sum_{m=1}^{j}\sum_{l=1}^{N}|H_{jm}(\omega)| cos(\omega_{ml}t - \theta(\omega_{ml}) + \phi_{ml})\\</script><p>谐波合成法的本质是以功率谱密度为加权系数, 通过一系列余弦信号的叠加来模拟脉动风速. 而实际过程中, 功率谱在频域内被离散为一系列频率点处的取值, 然后以离散的功率谱去逼近连续的功率谱, 在这个过程中不可避免的会产生误差. 具体就体现在, 生成的脉动风速时程的均值不为0. <strong>本程序建议先通过试算生成信号的湍流强度$I_u$是否满足要求, 以此作为$N$的取值参考. 同时, 本程序中也会强制将生成信号的均值置为0, 使用时请务必注意.</strong></p>
<h4 id="时间点数-M-的选取原则"><a href="#时间点数-M-的选取原则" class="headerlink" title="时间点数$M$的选取原则"></a>时间点数$M$的选取原则</h4><p><strong>采用WAWS生成的脉动风场可以理解为一个模拟信号$V_j(t)$(该信号在时间上连续的), 这个信号的频率上限为$\omega_{u}$, 包含$n\omega_{u}/N, n=0,1,2,…,N$个频率成分. 而最终使用的是从$V_j(t)$采样得到的离散的数字信号,所以应该遵从采样定理.</strong></p>
<p>根据合成公式, 生成的信号在每个频率点的周期为$T_l = 2 \pi / \omega_l = 2 \pi N / l \omega_u$, 叠加后的脉动风场也是周期函数, 其中的最长周期为</p>
<script type="math/tex; mode=display">
T_0 = \frac{2 \pi}{\omega_1} = \frac{2 \pi}{\Delta \omega} = \frac{2 \pi N}{\omega_u}</script><p>定义$M$为最长周期内的时间点数量, 即</p>
<script type="math/tex; mode=display">
T_0 = M \Delta t = \frac{2 \pi} {\Delta \omega} = \frac{2 \pi N}{\omega_u}\\
\Delta t = \frac{2 \pi} {\Delta \omega M} = \frac{2 \pi N}{\omega_u M} = \frac{1}{a} \frac{2 \pi}{\omega_u}, a =\frac{M}{N}</script><p>根据采样定理, 为了避免频率混叠, 从$V_{j}(t)$采样的采样频率必须满足如下关系</p>
<script type="math/tex; mode=display">
f_{s} \geq 2 f_{u} = 2 \frac{\omega_{u}}{2\pi}=\frac{\omega_{u}}{\pi}</script><p>因此</p>
<script type="math/tex; mode=display">
\Delta t = \frac{1}{f_s} \leq \frac{\pi}{\omega_u}</script><p><strong>注意:</strong>WAWS生成的模拟信号所包含的最高频率成分也仅为$\omega_u$, 采样得到的数字信号中的频率成分为$[0, \frac{f_s}{2}]$, 而其中高于$\omega_u=2\pi f_u$的部分都是虚假的(无效的)</p>
<p>模拟信号总持时:</p>
<script type="math/tex; mode=display">
T_0 = M \Delta t</script><p>根据上述公式, $\Delta t$的选取只要满足采样定理就一定能保证生成的脉动风的功率谱密度与目标谱一致. 然而, 考虑到模拟的脉动风速时程主要用于结构动力时程分析, 因此$\Delta t$ 的选择还应该考虑是否会影响结构计算的精度, 张军锋<sup><a href="#fn_2" id="reffn_2">2</a></sup>针对这个问题进行了研究, 在此只给出他的研究结论:</p>
<ol>
<li>$M/N \geq 2$后, $M/N$比值并不影响生成的脉动风功率谱密度与目标谱的一致性;但对应的$\Delta t$可能在动力时程计算中无法准确计入结构的共振响应,尤其当需要计及的结构频率在$\omega_u$附近时. 且如果$\Delta t$过大, 即使在动态时程分析时增加荷载子步(阶跃荷载或线性插值,原文采用ANSYS进行分析)也无法准确计入共振效应,必须减小模拟脉动风的采样间隔$\Delta t$</li>
<li>对单自由度系统而言, 当$M/N \geq 8$之后, 通过模拟风速时程计算的系统响应与理论解非常接近, 可以作为$M/N$取值的参考; 单自由度弹簧振子模型对$\Delta t$的要求最为苛刻, 可以作为普通结构的上限</li>
</ol>
<h4 id="模拟中时频参数选取建议和实施步骤"><a href="#模拟中时频参数选取建议和实施步骤" class="headerlink" title="模拟中时频参数选取建议和实施步骤"></a>模拟中时频参数选取建议和实施步骤</h4><p>根据上述分析, 关于$M, N$的选取可以按照如下步骤执行</p>
<ul>
<li><p><strong>Step 1: 合理确定周期$T_0$(模拟风速总时长$T$), 一般有$T_0 \geq T = 600 s$</strong></p>
<ul>
<li>通过WAWS生成的脉动风荷载主要用于结构的抖振分析, 因而10min以上的平均才具有统计意义</li>
<li><em>对于非平稳风场,还需了解更多文献</em></li>
</ul>
</li>
<li><p><strong>Step 2: 确定截止频率上限$\omega_u = 2 \pi f_u$, $f_u \geq f_{struct}$</strong></p>
<ul>
<li>$f_{struct}$为所关心的结构频率. 如对输电塔而言, $f_{struct}$可以取1阶扭转频率, 但如果需要计入高阶模态的影响,则应该考虑更高阶模态频率</li>
</ul>
</li>
<li><p><strong>Step 3: 确定频率点$N$, 通常可以取 $N = 1024$ 或$N=2048$ (确保$N &gt;1000$)</strong></p>
<ul>
<li><p>注意$N$越大模拟越精确,但是也更耗时</p>
</li>
<li><p>$N$将直接影响生成的脉动风速时程的均值和方差, 建议先通过试算生成信号的湍流强度$I_u$是否满足要求, 以此确定$N$的取值</p>
</li>
<li><p>频率点数$N$直接影响生成的脉动风信号的最长周期$T_0=\frac{2 \pi N}{\omega_u}$ , 因此选择$N$需要考虑到$T_0 &gt; T$</p>
</li>
</ul>
</li>
<li><p><strong>Step 4: 确定模拟时间点, 可以取$M = 8N$(确保$M\geq2N$)</strong></p>
</li>
</ul>
<p>按照上述步骤确定相关参数取值后:</p>
<script type="math/tex; mode=display">
\Delta \omega = \frac{\omega_u}{N} \\
\Delta t = \frac{T_0}{M}</script><h3 id="关于角频率-omega-和频率-f-频谱-功率谱等"><a href="#关于角频率-omega-和频率-f-频谱-功率谱等" class="headerlink" title="关于角频率$\omega $和频率$f$, 频谱, 功率谱等"></a>关于角频率$\omega $和频率$f$, 频谱, 功率谱等</h3><p>角频率或称圆频率$\omega (rad/s)$与频率$f (Hz)$之间存在如下关系:</p>
<script type="math/tex; mode=display">
\omega = 2 \pi f</script><p>如果输入的风谱和相干函数为频率的函数,即$S(f), coh(f)$, 那么经过cholesky分解后得到的下三角矩阵也应该为频率的函数$H(f)$, 因而在合成脉动风速时, 应该按照频率进行叠加</p>
<script type="math/tex; mode=display">
V_j(t) = 2\sqrt{\Delta f}\sum_{m=1}^{j}\sum_{l=1}^{N}\lvert H_{jm}(f) \rvert cos(\omega_{ml}t - \theta(\omega_{ml}) + \phi_{ml})</script><p>而$\Delta f = \Delta \omega / (2\pi)$</p>
<p>另一方面, 如果输入的风谱和相干函数为角频率的函数,即$S(w), coh(w)$, 那么采用则完全按照角频率的公式进行计算.  然而需要注意的是, 对生成的脉动风信号进行频谱分析时(采用scipy.signal.welch), 得到的是S(f); 而目标谱则为$S(w)$, 进行比较时需将二者统一.</p>
<h4 id="两种频率表示的频谱-F-omega-和-F-f"><a href="#两种频率表示的频谱-F-omega-和-F-f" class="headerlink" title="两种频率表示的频谱$F(\omega)$和$F(f)$"></a>两种频率表示的频谱$F(\omega)$和$F(f)$</h4><p>若存在随机信号$f(t), t\in (-\infty, \infty)$ 满足狄氏条件(信号存在傅里叶变换的<strong>充分不必要</strong>条件), 且绝对可积</p>
<script type="math/tex; mode=display">
\int_{-\infty}^{\infty}|f(t)|dt < \infty</script><p>$f(t)$的傅里叶逆变换为</p>
<script type="math/tex; mode=display">
f(t) = \frac{1}{2\pi} \int_{-\infty}^{\infty}F(\omega)e^{j\omega t}d\omega = \int_{-\infty}^{\infty}F(f) e^{j2\pi ft}df \\\\

傅里叶变换:\\\\
F(\omega) = \int_{-\infty}^{\infty}f(t)e^{-jwt}dt \\
F(f) = \int_{-\infty}^{\infty}f(t) e^{-j2\pi ft}dt</script><p>可以发现, 信号$f(t)$的频谱用$\omega$和$f$表示时存在一个压缩关系, 相差$2\pi$倍, 即$F(\omega)$和$F(f)$并不相等</p>
<h4 id="两种频率表示的功率谱密度-P-omega-和-P-f"><a href="#两种频率表示的功率谱密度-P-omega-和-P-f" class="headerlink" title="两种频率表示的功率谱密度$P(\omega)$和$P(f)$"></a>两种频率表示的功率谱密度$P(\omega)$和$P(f)$</h4><p>从能量角度出发(信号满足Parseval定理), 信号在一个周期内的总能量如下</p>
<script type="math/tex; mode=display">
E_T = \int_{-\infty}^{\infty}f^2(t)dt = \frac{1}{2\pi} \int_{-\infty}^{\infty}|F(\omega)|^2d\omega = \int_{-\infty}^{\infty}|F(f)|^2df</script><p>上式的含义是, 信号在时域内的能量与频域内的能量相等</p>
<p>那么一个周期内的平均功率如下</p>
<script type="math/tex; mode=display">
P = \lim\limits_{T\to\infty} \int_{-T/2}^{T/2} \frac{1}{T} f^2(t)dt = \frac{1}{2\pi} \int_{-\infty}^{\infty} \lim\limits_{T\to\infty} \frac{1}{T}|F(\omega)|^2d\omega = \int_{-\infty}^{\infty} \lim\limits_{T\to\infty} \frac{1}{T} |F(f)|^2df</script><p>$f(t)$的功率谱</p>
<script type="math/tex; mode=display">
P(\omega) = \lim\limits_{T\to\infty} \frac{|F(\omega)|^2}{2\pi T} \\
P(f) = \lim\limits_{T\to\infty} \frac{|F(f)|^2}{T}</script><p>注意: $P(\omega)$与$P(f)$并不相等</p>
<script type="math/tex; mode=display">
P = \int_{-\infty}^{\infty}P(\omega)d\omega = \int_{-\infty}^{\infty} P(f)df\\
P(f) = 2\pi P(\omega)</script><p><img src="https://gitee.com/ginkgoltd/pictures/raw/master/img/Fig1.jpg" alt=""></p>
<script type="math/tex; mode=display">PSD = \lim_{T\to\infty}\frac{E[|\hat{f_{T}}(\omega)|^2]}{2T}</script><p>正如示意图所示, 同一信号的功率谱密度$P(f)$和$P(\omega)$所蕴含的总能量应该是相等的</p>
<p>另一方面从相关关系的角度也能得出相同的关系</p>
<script type="math/tex; mode=display">
P(\omega) = \frac{1}{2\pi} \int Rxx(\tau) e^{-j\omega \tau} d\tau \\
P(f) =\int Rxx(\tau) e^{-j2\pi f\tau} d\tau \\
P(f) = 2\pi P(\omega)</script><p>也即是说$P(f)$与$P(\omega)$不是同一个函数, 为了方面理解可以改写为$P_f(f)$和$P_{\omega}(f)$. 同理, 对于风速谱$S(f)$与$S(\omega)$也存在相同的关系. 实际工程中通常将风速谱表示为物理频率$f$的函数, 如Davenport谱</p>
<script type="math/tex; mode=display">
\frac{f S_f(f)} {\sigma_u^2} = \frac{2x^2}{3(1 + x^2)^{\frac{4}{3}}}\\
x = \frac{fL_u}{\bar{v}}\\
L = 1200 m</script><p>上式中, 可以用$\omega=2\pi f$进行替换得到$S_f(\omega)$, 但需要注意得到的函数$S_f(\omega)$并不等于$S_{\omega}(\omega)$, 二者还存在一个$2\pi$的系数, 两者之间的真实关系如下</p>
<script type="math/tex; mode=display">
S_f(f)=S_f(\omega) = 2\pi S_{\omega}(\omega)</script><h4 id="单边谱与双边谱"><a href="#单边谱与双边谱" class="headerlink" title="单边谱与双边谱"></a>单边谱与双边谱</h4><p>现实世界不存在负频率</p>
<script type="math/tex; mode=display">
P_{oneside}(\omega) = 2P_{twoside}(\omega)</script><h4 id="程序中关于风谱的使用说明"><a href="#程序中关于风谱的使用说明" class="headerlink" title="程序中关于风谱的使用说明"></a>程序中关于风谱的使用说明</h4><ol>
<li>风工程中的风谱多表示成物理频率$f$的函数, 因此本程序编写的风谱函数均为$S_f(f)$, 在使用自编的风谱函数时,请务必注意</li>
<li>风谱函数$S_f(f)$为单边谱, 而在生成互谱密度矩阵时采用的是双边谱, 因此需要$S_f(f)/2$</li>
<li>考虑到上述谐波合成法理论中, 风谱均表示为角频率$\omega$的函数, 因此在<code>GustWindField class</code>中将输入的目标功率谱$S_f(f)$转换为$S_{\omega}(\omega)$</li>
<li>为了减少计算量, 按照风谱函数计算的目标将存储在<code>target</code>属性中, 对比生成信号功率谱和目标功率谱一致性时, 将直接调用这个数据</li>
<li>生成信号的功率谱采用welch方法计算(<code>scipy.singal.welch</code>), 得到的结果是$S_v(f)$; 因此将<code>target</code>中存储的数据转换后进行对比, 具体方法为: 横坐标$f=\omega/(2\pi)$, 纵坐标: $S_v(f) = target * 2  \pi$; (具体原理见2.2节)</li>
</ol>
<h3 id="WAWS合成法的加速"><a href="#WAWS合成法的加速" class="headerlink" title="WAWS合成法的加速"></a>WAWS合成法的加速</h3><p>根据文献<sup><a href="#fn_1" id="reffn_1">1</a></sup>Deodatis引入双索引频率的目的在于减小模拟样本的周期性, 同时可以实现生成的脉动风场的各态历经性.  从下面的表达式可以看出, 如果</p>
<script type="math/tex; mode=display">
V_j(t) = 2\sqrt(\Delta \omega) \sum_{m=1}^{j} \sum_{l=1}^{N}|H_{jm}(\omega_{l})cos(\omega_l t + \theta_{jm}(\omega_l) + \phi_{ml})\\
\omega_l = l\Delta\omega, l = 1,2,3,...,N</script><p>然而引入双索引频率$\omega_{ml}, m=1, 2, …, npts; l = 1, 2, 3, …, N$后, <code>cholesky</code>分解的运算量将从$N$次陡增到$npts \times N$次.  </p>
<p><code>cholesky</code>分解算法的最优时间复杂度为$o(n^3)$,$n$ 为矩阵维度. 因此当需要模拟的点数较多时, 整个算法将变得非常耗时. 为了提升<code>WAWS</code>的计算效率, 一些加速算法被相继提出来, 这些算法主要分为两类, 一类是对$H(\omega)$进行插值, 从而达到减少<code>cholesky</code>分解次数的目的; 另一类是对$S_{ij}(\omega)$矩阵进行降维度(主要采用<code>POD</code>算法), 进而合成脉动风荷载. 关于这方面的研究很多<sup><a href="#fn_5" id="reffn_5">5</a></sup>, 本程序暂且没有考虑通过算法优化的方式来加速计算, 而是直接采用了并行计算来加速$H(\omega)$矩阵的分解, 这样做的目的一方面是避免插值或者<code>POD</code>带来的误差, 另一方面是可以充分利用现有的计算资源. </p>
<p><code>WAWS</code>算法中另一处比较耗时的计算在于脉动风荷载的合成, 尤其是当模拟点$npts$, 频率点$N$和时间点$M$都比较多时, 采用<code>ifft</code>算法可以显著降低这部分耗时, 程序中也默认使用这一方法.</p>
<h3 id="风场相关参数的选择"><a href="#风场相关参数的选择" class="headerlink" title="风场相关参数的选择"></a>风场相关参数的选择</h3><p>主要参考文献<sup><a href="#fn_6" id="reffn_6">6</a></sup>, 文章中很多关于规范的取值都是基于较早的规范的, (暂时用不上所以没有更新, 欢迎大家更新或者留言)</p>
<h4 id="平均风剖面"><a href="#平均风剖面" class="headerlink" title="平均风剖面"></a>平均风剖面</h4><p>本程序仅支持指数律风剖面(且并未留有相关的接口用于改变风剖面的计算, 使用者若想修改请自行阅读和修改源码)</p>
<script type="math/tex; mode=display">
\bar{v} = \bar{v}_s (\frac{z}{z_s}) ^ \alpha = \bar{v}_{10} (\frac{z}{z_{10}}) ^ \alpha</script><p>Table 3. 各国规范中的风剖面指数$\alpha$</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>粗糙度类别</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>中国 GB50009-2012</td>
<td>0.12</td>
<td>0.15</td>
<td>0.22</td>
<td>0.30</td>
<td></td>
</tr>
<tr>
<td><strong>粗糙度类别</strong></td>
<td><strong>D</strong></td>
<td><strong>C</strong></td>
<td><strong>B</strong></td>
<td><strong>A</strong></td>
<td></td>
</tr>
<tr>
<td>美国 ASCE7-95</td>
<td>1/9.0</td>
<td>1/6.5</td>
<td>1/4.0</td>
<td>1/3.0</td>
<td></td>
</tr>
<tr>
<td><strong>粗糙度类别</strong></td>
<td><strong>I</strong></td>
<td><strong>II</strong></td>
<td><strong>III</strong></td>
<td><strong>IV</strong></td>
<td><strong>V</strong></td>
</tr>
<tr>
<td>日本建筑学会 1993</td>
<td>0.10</td>
<td>0.15</td>
<td>0.20</td>
<td>0.27</td>
<td>0.35</td>
</tr>
</tbody>
</table>
</div>
<p>Table 4. 各国规范中的梯度风高度</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>粗糙度类别</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>中国 GB50009-2012 (m)</td>
<td>300</td>
<td>350</td>
<td>450</td>
<td>550</td>
<td></td>
</tr>
<tr>
<td><strong>粗糙度类别</strong></td>
<td><strong>D</strong></td>
<td><strong>C</strong></td>
<td><strong>B</strong></td>
<td><strong>A</strong></td>
<td></td>
</tr>
<tr>
<td>美国 ASCE7-95 (ft/m)</td>
<td>700/213</td>
<td>900/274</td>
<td>1200/366</td>
<td>1500/457</td>
<td></td>
</tr>
<tr>
<td><strong>粗糙度类别</strong></td>
<td><strong>I</strong></td>
<td><strong>II</strong></td>
<td><strong>III</strong></td>
<td><strong>IV</strong></td>
<td><strong>V</strong></td>
</tr>
<tr>
<td>日本建筑学会 1993 (m)</td>
<td>250</td>
<td>350</td>
<td>450</td>
<td>550</td>
<td>650</td>
</tr>
</tbody>
</table>
</div>
<h4 id="湍流强度"><a href="#湍流强度" class="headerlink" title="湍流强度"></a>湍流强度</h4><p>对高耸结构而言, 其抖振响应主要受到湍流强度的影响, 因此在模拟脉动风场时, 应当准确反应湍流强度的基本特征(主要是沿高度的变化).  <strong>以下皆为个人理解, 未在文献中看到明确说明:</strong> 在模拟风场时, 应当指定湍流强度随高度的变化特征, 然后在计算风谱时应该使得各高度处的风谱满足$\int_0^{\infty}S_u(\omega)d\omega = \sigma_u^2$. 在完成风速合成后, 也应该检查生成的风场的湍流强度与指定的湍流强度之间是否吻合.</p>
<p>湍流强度的定义如下</p>
<script type="math/tex; mode=display">
I_u(z) = \frac{\sigma_u(z)}{\bar{v}(z)}</script><p>式中, $\sigma_u(z)$为脉动风速标准差, $\bar{v}(z)$为$z$高度处的平均风速</p>
<p>随着高度的增加, $\sigma_u(z)$略有减小, 而平均风速$\bar{v}(z)$则递增, 所以湍流强度是随高度增加而减小的. 通常可以表示成如下指数函数</p>
<script type="math/tex; mode=display">
I_u(z) = c (\frac{z}{10})^{-d}</script><p>式中, $c,d$是与地形地貌有关的参数</p>
<p>中国规范中的湍流强度表达式(GB50009-2012)</p>
<script type="math/tex; mode=display">
I_u(z) = I_{10} \bar{I}_z(z) = I_{10} (\frac{z} {10}) ^{-\alpha}</script><p>$\alpha$为地面粗糙度指数, 按Table 3取值</p>
<p> Table 5. 各国湍流强度特征参数 ($c$, 中国规范中的$I_{10}$)</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">粗糙度类别</th>
<th style="text-align:center">A</th>
<th style="text-align:center">B</th>
<th style="text-align:center">C</th>
<th style="text-align:center">D</th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">中国 GB50009-2012, $I_{10}$</td>
<td style="text-align:center">0.12</td>
<td style="text-align:center">0.14</td>
<td style="text-align:center">0.23</td>
<td style="text-align:center">0.39</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><strong>粗糙度类别</strong></td>
<td style="text-align:center"><strong>D</strong></td>
<td style="text-align:center"><strong>C</strong></td>
<td style="text-align:center"><strong>B</strong></td>
<td style="text-align:center"><strong>A</strong></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">美国 ASCE7-95, $c$</td>
<td style="text-align:center">0.15</td>
<td style="text-align:center">0.2</td>
<td style="text-align:center">0.3</td>
<td style="text-align:center">0.45</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">$d$</td>
<td style="text-align:center">0.167</td>
<td style="text-align:center">0.167</td>
<td style="text-align:center">0.167</td>
<td style="text-align:center">0.167</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"><strong>粗糙度类别</strong></td>
<td style="text-align:center"><strong>I</strong></td>
<td style="text-align:center"><strong>II</strong></td>
<td style="text-align:center"><strong>III</strong></td>
<td style="text-align:center"><strong>IV</strong></td>
<td style="text-align:center"><strong>V</strong></td>
</tr>
<tr>
<td style="text-align:center">日本建筑学会 1993 , $c$</td>
<td style="text-align:center">0.162</td>
<td style="text-align:center">0.203</td>
<td style="text-align:center">0.259</td>
<td style="text-align:center">0.361</td>
<td style="text-align:center">0.531</td>
</tr>
<tr>
<td style="text-align:center">$d$</td>
<td style="text-align:center">0.15</td>
<td style="text-align:center">0.20</td>
<td style="text-align:center">0.25</td>
<td style="text-align:center">0.32</td>
<td style="text-align:center">0.40</td>
</tr>
</tbody>
</table>
</div>
<h4 id="积分尺度"><a href="#积分尺度" class="headerlink" title="积分尺度"></a>积分尺度</h4><p>湍流积分尺度是气流中湍流涡旋平均尺寸的量度, 湍流积分尺度的定义如下</p>
<script type="math/tex; mode=display">
L_u^e = \frac{1}{\sigma_u^2} \int_0^{\infty} R_{u_1 u_2}(r)dr</script><p>式中, $u$为顺风向脉动风速分量; $\sigma_u$为脉动风速的标准差; $R_{u_1 u_2}(r)$ 为互相关函数; $e$为与顺风向脉动风速分量有关的旋涡方向, 一共三个, 分别是顺风向, 横风向, 竖向. 同理另外两个脉动风速分量也分别有三个旋涡方向; 也即是湍流积分尺度共有9个.</p>
<p>由于我国规范采用与积分尺度不随高度变化的Davenport谱, 因此没有规定湍流积分尺度的表达式, 其他国家的规范如下</p>
<p>美国ASCE7: $L_{\bar{z}} = l (\frac{\bar{z}}{10})^ {\bar{\epsilon}}$, $l, \bar{\epsilon}$取决于地形</p>
<p>日本RLB-AIJ: $L_H = 100 (\frac{H}{30})^{0.5}$</p>
<h4 id="脉动风速谱"><a href="#脉动风速谱" class="headerlink" title="脉动风速谱"></a>脉动风速谱</h4><p>自然界某一时段内的脉动风速可以用平稳随机过程来模拟，因此脉动风功率谱就成为表达脉动风速特性的主要方式. 采用WAWS合成脉动风速时程时, 最重要的参数便是风谱. </p>
<p>目前各国规范中主要采用的顺风向风速谱如下:</p>
<ol>
<li>Davenport谱</li>
</ol>
<script type="math/tex; mode=display">
\frac{n S_u(n)} {\sigma_u^2} = \frac{2x^2}{3(1 + x^2)^{\frac{4}{3}}}\\
x = \frac{nL_u}{\bar{v}_{10}}\\
L = 1200 m</script><p>Davenport谱假定湍流积分尺度$L$不随高度改变, 取为1200m, 中国规范采用Davenport谱.</p>
<ol>
<li>Kaimal谱</li>
</ol>
<script type="math/tex; mode=display">
\frac{n S_u(n)} {\sigma_u^2} = \frac{a_1 x}{(1 + a_2 x)^{\frac{5}{3}}}\\
x = \frac{nL_u}{\bar{v}}\\
l_{\bar{z}} = l (\frac{\bar{z}}{10})^{\bar{\epsilon}}
a_1 = 6.868, a_2 = 10.302</script><p>美国规范采用该谱, 欧洲规范也采用该谱</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>地形</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
</thead>
<tbody>
<tr>
<td>$l (ft)$</td>
<td>54.864</td>
<td>97.536</td>
<td>152.400</td>
<td>198.120</td>
</tr>
<tr>
<td>$\epsilon$</td>
<td>1/0.6096</td>
<td>1/0.9144</td>
<td>1/1.5240</td>
<td>1/2.4384</td>
</tr>
</tbody>
</table>
</div>
<p>注：美国规范中地形类别的 A、 B、 C、 D，分别对应着我国规范中的 D、 C、 B、 A 类别</p>
<ol>
<li>Von Karman谱</li>
</ol>
<script type="math/tex; mode=display">
\frac{n S_u(n)} {\sigma_u^2} = \frac{4x}{(1 + 70.8 x^2)^{\frac{5}{6}}}\\
x = \frac{nL_u}{\bar{v}}\\
L_u = L_H = 100 (\frac{H}{30})^{0.5}</script><p>日本规范采用该谱</p>
<ol>
<li>Harris谱</li>
</ol>
<script type="math/tex; mode=display">
\frac{n S_u(n)} {\sigma_u^2} = \frac{0.6x}{(2 + x^2)^{\frac{5}{6}}}\\
x = \frac{nL_u}{\bar{v}}\\
L = 1800 m</script><p>澳大利亚规范采用该谱</p>
<ol>
<li>Simiu谱<br><strong>不保证对, 请自行核实</strong></li>
</ol>
<script type="math/tex; mode=display">
\frac{n S_u(n)} {\sigma_u^2} = \left \{
\begin{aligned}
\frac{100x}{3(1 + 50 x)^{\frac{5}{3}}}, x \leq 0.2\\
\frac{0.0433}{x ^{2/3}}, x > 0.2\\
\end{aligned}
\right. \\
x = \frac{nz}{\bar{v}}\\</script><p>理想的谱形式应该满足以下三个条件:</p>
<script type="math/tex; mode=display">
条件1\quad \int_0^{\infty} \frac{S_u(n)}{\sigma_u^2} dn = 1 \\
条件2\quad S_u(0) = 4 \sigma_u^2 \frac{L_u}{\bar{v}} \\
条件3\quad \frac{n S_u(n)} {\sigma_u^2} = A (\frac{nL_u}{\bar{v}})^{-2/3}, A=0.10~0.15\\</script><p><strong>条件1为必要条件</strong>, 可以保证脉动风速的方差等于曲线$S_u(n)$所覆盖的面积, 并与湍流强度相容;<br>条件2可以通过自相关函数和谱密度之间的维纳-辛钦关系得到.<br>条件3要求高频部分满足该式的形式, 主要和结构响应有关</p>
<p>总体来说, Davenport谱和Harris谱不随高度变化, Von Karman谱和Kaimal谱考虑了湍流积分尺度随高度的变化. Davenport谱的谱值偏大, 可能会过高的轨迹结构的抖振响应, 致使计算结果偏于保守. Von Karman 谱是一种理想的形式, 只有它满足上述3个条件<sup><a href="#fn_6" id="reffn_6">6</a></sup>.<br>ben</p>
<h4 id="空间相关性"><a href="#空间相关性" class="headerlink" title="空间相关性"></a>空间相关性</h4><p>相干函数定义如下</p>
<script type="math/tex; mode=display">
\rho_{xy} (\omega) = \frac{S_{xy}(\omega)}{\sqrt{S_x(\omega)S_y(\omega)}}\\
0 \leq \rho_{xy}(\omega) \leq 1</script><ol>
<li>Davenport相关函数</li>
</ol>
<script type="math/tex; mode=display">
\rho(n) = exp[\frac{-n \sqrt{c_x^2 (x_1 - x_2)^2 + c_z^2 (z_1 - z_2)^2}}{\bar{v}_1 \bar{v}_2}]\\
c_x = 8, c_z = 7</script><ol>
<li>Shiotani相关函数 - 与频率无关<script type="math/tex; mode=display">
\rho_z = exp[\frac{-|z_1 - z_2|} {60}]\\
\rho_x = exp[\frac{-|x_1 - x_2|} {50}]\\</script>我国建筑结构荷载规范(GB50009-2012)采用改相关函数</li>
</ol>
<p>本程序中暂时只实现了Davenport相关函数</p>
<h4 id="风场相关参数的选择建议"><a href="#风场相关参数的选择建议" class="headerlink" title="风场相关参数的选择建议"></a>风场相关参数的选择建议</h4><p><strong>总体原则: </strong></p>
<ol>
<li>选择风场相关参数时, 可以根据需要使用的<strong>规范</strong>来确定相关参数的取值</li>
<li>鉴于本人的需求, 目前只简单的实现了风谱的自定义功能, 即用户可以根据自己的需求编写风谱函数, 然后在模拟时调用. 其他参数都是直接在<code>GustWindField clas</code>内部集成, 用户如果需要使用其他自定义参数, 需要自行在源码中修改</li>
<li>本人目前只需要用到中国规范, 因此只能保证程序中关于中国规范的参数是正确的, 其余的参数还请使用者自行检查</li>
</ol>
<p><strong>补充:</strong>目前关于自定义风谱的实现非常粗略, 采用的是<code>eval()</code>函数, 以后应该会修改为直接传递风谱(或其他)函数作为参数, 从而实现自定义参数的输入</p>
<p><strong>一些细节:</strong></p>
<ol>
<li>平均风剖面: 仅支持<strong>指数律</strong><ul>
<li>需要输入$v_{10}$和风剖面指数$\alpha$两个参数, 见Table 3</li>
</ul>
</li>
<li>湍流强度<ul>
<li>需要输入$I_{10}或(c), d$两个参数, 见Table 5</li>
<li>湍流强度沿高度的变化将直接反应到风谱中, 最终生成的风场的湍流强度也应该与输入的湍流强度吻合</li>
</ul>
</li>
<li>脉动风谱和积分尺度<ul>
<li>前文给出的风谱$S(n)$都是物理频率$n$的函数, 本程序在使用时都先转换成了圆频率的函数$S(\omega)$(见2.2.4节, $\omega = 2 \pi n$)</li>
<li>根据第2条, 在计算风谱时, 将直接给定该高度处的湍流强度值</li>
<li>积分尺度的选择可以按照各风谱的规定进行选择</li>
</ul>
</li>
<li><p>空间相关性</p>
<ul>
<li>本程序中暂时只能使用davenport 相关函数</li>
</ul>
</li>
</ol>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><blockquote id="fn_1">
<sup>1</sup>. &lt;大跨度桥梁脉动风场模拟的插值算法&gt;(祝志文)<a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_2">
<sup>2</sup>. &lt;基于实测风特性的台风模拟&gt;(杨素珍)<a href="#reffn_2" title="Jump back to footnote [2] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_3">
<sup>3</sup>. &lt;谐波合成法脉动风模拟时间步长的取值&gt;(张军锋)<a href="#reffn_3" title="Jump back to footnote [3] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_4">
<sup>4</sup>. Shinozuka M, Deodatis G. Simulation of stochastic processes by spectral representation[J]. Applied mechanics reviews. 1991, 44(4): 191-204<a href="#reffn_4" title="Jump back to footnote [4] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_5">
<sup>5</sup>. &lt;台风作用下大跨斜拉桥抖振非平稳效应模拟与实测研究&gt; 陶天友<a href="#reffn_5" title="Jump back to footnote [5] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_6">
<sup>6</sup>. &lt;中美日建筑结构抗风设计规范的比较研究&gt; 赵杨<a href="#reffn_6" title="Jump back to footnote [6] in the text."> &#8617;</a>
</blockquote>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>Post title：谐波合成法的Python实现及其使用手册</li>
        <li>Post author：GinkGo</li>
        <li>Create time：2021-06-13 00:41:02</li>
        <li>
            Post link：https://ginkgoltd.github.io/2021/06/13/WAWS/
        </li>
        <li>
            Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.
        </li>
    </ul>
</div>

            </div>
        

        
            <div class="article-nav">
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2021/05/07/openVFIFE/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">openVFIFE</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
        
        
            
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
          
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2021</span>&nbsp;-&nbsp;
            
            2021&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">GinkGo</a>
        </div>
        
            <script async  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.3</a>
        </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B0%90%E6%B3%A2%E5%90%88%E6%88%90%E6%B3%95%E5%9F%BA%E6%9C%AC%E6%AD%A5%E9%AA%A4"><span class="nav-number">1.</span> <span class="nav-text">谐波合成法基本步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E%E4%B8%80%E4%BA%9B%E5%8F%82%E6%95%B0%E7%9A%84%E9%80%89%E6%8B%A9"><span class="nav-number">2.</span> <span class="nav-text">关于一些参数的选择</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E%E6%A8%A1%E6%8B%9F%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94-Delta-t-%E7%9A%84%E9%80%89%E5%8F%96"><span class="nav-number">2.1.</span> <span class="nav-text">关于模拟时间间隔$\Delta t$的选取</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%91%E7%8E%87%E7%82%B9%E6%95%B0-N-%E7%9A%84%E9%80%89%E5%8F%96%E5%8E%9F%E5%88%99"><span class="nav-number">2.1.1.</span> <span class="nav-text">频率点数$N$的选取原则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%B6%E9%97%B4%E7%82%B9%E6%95%B0-M-%E7%9A%84%E9%80%89%E5%8F%96%E5%8E%9F%E5%88%99"><span class="nav-number">2.1.2.</span> <span class="nav-text">时间点数$M$的选取原则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%A1%E6%8B%9F%E4%B8%AD%E6%97%B6%E9%A2%91%E5%8F%82%E6%95%B0%E9%80%89%E5%8F%96%E5%BB%BA%E8%AE%AE%E5%92%8C%E5%AE%9E%E6%96%BD%E6%AD%A5%E9%AA%A4"><span class="nav-number">2.1.3.</span> <span class="nav-text">模拟中时频参数选取建议和实施步骤</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E%E8%A7%92%E9%A2%91%E7%8E%87-omega-%E5%92%8C%E9%A2%91%E7%8E%87-f-%E9%A2%91%E8%B0%B1-%E5%8A%9F%E7%8E%87%E8%B0%B1%E7%AD%89"><span class="nav-number">2.2.</span> <span class="nav-text">关于角频率$\omega $和频率$f$, 频谱, 功率谱等</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%A4%E7%A7%8D%E9%A2%91%E7%8E%87%E8%A1%A8%E7%A4%BA%E7%9A%84%E9%A2%91%E8%B0%B1-F-omega-%E5%92%8C-F-f"><span class="nav-number">2.2.1.</span> <span class="nav-text">两种频率表示的频谱$F(\omega)$和$F(f)$</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%A4%E7%A7%8D%E9%A2%91%E7%8E%87%E8%A1%A8%E7%A4%BA%E7%9A%84%E5%8A%9F%E7%8E%87%E8%B0%B1%E5%AF%86%E5%BA%A6-P-omega-%E5%92%8C-P-f"><span class="nav-number">2.2.2.</span> <span class="nav-text">两种频率表示的功率谱密度$P(\omega)$和$P(f)$</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E8%BE%B9%E8%B0%B1%E4%B8%8E%E5%8F%8C%E8%BE%B9%E8%B0%B1"><span class="nav-number">2.2.3.</span> <span class="nav-text">单边谱与双边谱</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E4%B8%AD%E5%85%B3%E4%BA%8E%E9%A3%8E%E8%B0%B1%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E"><span class="nav-number">2.2.4.</span> <span class="nav-text">程序中关于风谱的使用说明</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WAWS%E5%90%88%E6%88%90%E6%B3%95%E7%9A%84%E5%8A%A0%E9%80%9F"><span class="nav-number">2.3.</span> <span class="nav-text">WAWS合成法的加速</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A3%8E%E5%9C%BA%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0%E7%9A%84%E9%80%89%E6%8B%A9"><span class="nav-number">2.4.</span> <span class="nav-text">风场相关参数的选择</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B9%B3%E5%9D%87%E9%A3%8E%E5%89%96%E9%9D%A2"><span class="nav-number">2.4.1.</span> <span class="nav-text">平均风剖面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B9%8D%E6%B5%81%E5%BC%BA%E5%BA%A6"><span class="nav-number">2.4.2.</span> <span class="nav-text">湍流强度</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A7%AF%E5%88%86%E5%B0%BA%E5%BA%A6"><span class="nav-number">2.4.3.</span> <span class="nav-text">积分尺度</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%84%89%E5%8A%A8%E9%A3%8E%E9%80%9F%E8%B0%B1"><span class="nav-number">2.4.4.</span> <span class="nav-text">脉动风速谱</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A9%BA%E9%97%B4%E7%9B%B8%E5%85%B3%E6%80%A7"><span class="nav-number">2.4.5.</span> <span class="nav-text">空间相关性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A3%8E%E5%9C%BA%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0%E7%9A%84%E9%80%89%E6%8B%A9%E5%BB%BA%E8%AE%AE"><span class="nav-number">2.4.6.</span> <span class="nav-text">风场相关参数的选择建议</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#References"><span class="nav-number">3.</span> <span class="nav-text">References</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/code-copy.js"></script>




<div class="post-scripts">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/toc.js"></script>
    
</div>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
